<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}LeadGen{% endblock %}</title>

    <!-- ==== FONTS ==== -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=DM+Sans:wght@400;700&display=swap" rel="stylesheet">

    <!-- ==== GLOBAL STYLES ==== -->
    <style>
        /* ------------------------------------------------------------------ */
        /* CSS Custom Properties – Base Theme (kept exactly as you wrote)   */
        /* ------------------------------------------------------------------ */
        :root {
            --color-background: #ffffff;
            --color-surface: #f8f9fa;
            --color-text-primary: #212529;
            --color-text-secondary: #495057;
            --color-primary: #0056b3;
            --color-border: #e9ecef;
            --font-family-sans-serif: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --font-weight-bold: 600;
            --navbar-height: 80px;
            --navbar-padding: 1.5rem;
            --container-width: 100%;
            --border-radius: 8px;
            --transition-speed: 0.3s;
        }

        /* ------------------------------------------------------------------ */
        /* Marketing Theme (CTA, etc.) – merged with the base theme          */
        /* ------------------------------------------------------------------ */
        :root {
            --color-cta: #ff4757;
            --color-cta-text: #ffffff;
            --color-cta-shadow: rgba(255,71,87,0.4);
            --color-link-secondary: #5f5f65;
            --font-family-sans-serif: "DM Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        *, *::before, *::after { box-sizing: border-box; }
        body { margin:0; font-family:var(--font-family-sans-serif); line-height:1.6; background:#fff; }
        a { text-decoration:none; color:var(--color-text-secondary); transition:color var(--transition-speed) ease; }
        a:hover, a:focus { color:var(--color-primary); }

        /* ------------------------------------------------------------------ */
        /* Navbar (mobile + desktop)                                          */
        /* ------------------------------------------------------------------ */
        .navbar { position:sticky; top:0; z-index:1000; height:var(--navbar-height); display:flex; align-items:center;
                  background:var(--color-background); box-shadow:0 2px 5px rgba(0,0,0,.05); }
        .navbar__container { display:flex; justify-content:space-between; align-items:center;
                             width:100%; max-width:var(--container-width); margin:0 auto; padding:0 var(--navbar-padding); }
        .navbar__brand { font-size:1.75rem; font-weight:var(--font-weight-bold); color:var(--color-text-primary); }

        .navbar__toggle { display:block; border:none; background:transparent; cursor:pointer; }
        .navbar__toggle .bar { display:block; width:22px; height:2px; margin:6px 0; background:var(--color-text-primary);
                               transition:transform var(--transition-speed) ease; }
        .navbar__toggle.is-active .bar:nth-child(1){transform:translateY(8px) rotate(45deg);}
        .navbar__toggle.is-active .bar:nth-child(2){opacity:0;}
        .navbar__toggle.is-active .bar:nth-child(3){transform:translateY(-8px) rotate(-45deg);}

        .navbar__menu { display:none; }
        .navbar__menu.is-active { display:block; position:absolute; top:var(--navbar-height); left:0; width:100%;
                                  background:var(--color-background); box-shadow:0 8px 16px rgba(0,0,0,.1); }

        .navbar__list { margin:0; padding:0; list-style:none; }
        .navbar__item:not(:last-child){ border-bottom:1px solid var(--color-border); }
        .navbar__link { display:flex; align-items:center; padding:1.25rem var(--navbar-padding); font-weight:500; }
        .navbar__link:not(.navbar__link--cta){ color:var(--color-link-secondary); }
        .navbar__link:not(.navbar__link--cta):hover{ color:var(--color-text-primary); }

        .navbar__link--cta { color:var(--color-cta-text); background:var(--color-cta);
                             padding:.75rem 1.5rem; border-radius:50px; font-weight:var(--font-weight-bold);
                             transition:transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease; }
        .navbar__link--cta:hover, .navbar__link--cta:focus-visible{
            transform:translateY(-2px); box-shadow:0 8px 20px var(--color-cta-shadow); }

        /* ------------------------------------------------------------------ */
        /* Desktop (≥992px)                                                   */
        /* ------------------------------------------------------------------ */
        @media (min-width:992px){
            .navbar__toggle{display:none;}
            .navbar__menu{display:flex; position:static; width:auto; background:none; box-shadow:none;}
            .navbar__list{display:flex; align-items:center; gap:2rem;}
            .navbar__item:not(:last-child){border:none;}
            .navbar__link{padding:.5rem; position:relative;}
            .navbar__link:not(.navbar__link--cta)::after{
                content:''; position:absolute; bottom:0; left:0; width:0; height:2px;
                background:var(--color-text-primary); transition:width var(--transition-speed) ease;
            }
            .navbar__link:not(.navbar__link--cta):hover::after,
            .navbar__link:not(.navbar__link--cta):focus::after{width:100%;}
            .navbar__item--cta{margin-left:1rem;}
        }

        /* ------------------------------------------------------------------ */
        /* Mega-Menu (mobile accordion + desktop full-width)                 */
        /* ------------------------------------------------------------------ */
        .mega-menu-toggle{justify-content:space-between; width:100%;}
        .mega-menu-toggle::after{content:'right arrow'; font-size:1.5em; transform:rotate(90deg);
                                 transition:transform var(--transition-speed) ease;}
        .mega-menu-item.is-active > .mega-menu-toggle::after{transform:rotate(-90deg);}
        .mega-menu{max-height:0; overflow:hidden; background:var(--color-surface);
                   transition:max-height var(--transition-speed) ease-in-out;}
        .mega-menu-item.is-active > .mega-menu{max-height:1200px;}

        @media (min-width:992px){
            .mega-menu-toggle::after{content:'down arrow'; transform:rotate(0);}
            .mega-menu-item{position:static;}
            .mega-menu{display:block; position:absolute; top:calc(var(--navbar-height)-5px);
                        left:50%; transform:translateX(-50%); width:90vw; max-width:900px;
                        background:var(--color-background); border:1px solid var(--color-border);
                        border-radius:var(--border-radius); box-shadow:0 10px 30px rgba(0,0,0,.1);
                        opacity:0; visibility:hidden; transition:opacity var(--transition-speed) ease,
                        visibility var(--transition-speed) ease;}
            .mega-menu-item:hover > .mega-menu,
            .mega-menu-item:focus-within > .mega-menu{opacity:1; visibility:visible;}
            .mega-menu__content{padding:1.5rem;}
            .mega-menu__grid{display:grid; grid-template-columns:repeat(3,1fr); gap:2rem;}
            .mega-menu__heading{display:block; font-size:.9rem; font-weight:var(--font-weight-bold);
                                 text-transform:uppercase; color:var(--color-text-secondary);
                                 margin-bottom:1rem; padding:0 .75rem;}
        }

        /* ------------------------------------------------------------------ */
        /* Footer (wave divider + grid)                                       */
        /* ------------------------------------------------------------------ */
        :root{
            --footer-bg:#222529; --footer-text:#adb5bd; --footer-heading:#fff;
            --footer-link-hover:#fff; --footer-border:#3b3f44;
        }
        .footer-divider{line-height:0; background:#fff;}
        .footer-divider svg{display:block; width:100%; height:80px; fill:var(--footer-bg);}
        .footer-wave{background:var(--footer-bg); color:var(--footer-text);
                     padding:2rem 0 3rem; font-size:.9rem; line-height:1.6; margin-top:-1px;}
        .footer-wave__main-grid{display:grid; grid-template-columns:1fr; gap:2.5rem;}
        .footer-wave__heading{color:var(--footer-heading); font-size:1rem; font-weight:600; margin:0 0 1rem;}
        .footer-wave__links a{color:var(--footer-text); transition:color .2s;}
        .footer-wave__links a:hover{color:var(--footer-link-hover);}
        .footer-wave__bottom{margin-top:3rem; padding-top:1.5rem; border-top:1px solid var(--footer-border);
                             display:flex; flex-direction:column; align-items:center; gap:1.5rem; text-align:center;}
        .footer-wave__copyright{font-size:.875em;}
        @media(min-width:600px){.footer-wave__main-grid{grid-template-columns:repeat(2,1fr);}}
        @media(min-width:992px){.footer-wave__main-grid{grid-template-columns:1.5fr 1fr 1fr 1fr;}
                               .footer-wave__bottom{flex-direction:row; justify-content:space-between;}}

        /* ------------------------------------------------------------------ */
        /* Team Member Card                                                   */
        /* ------------------------------------------------------------------ */
        .tm-card{--tm-card-radius:12px; --tm-card-padding:2rem 1.5rem; --tm-card-shadow:0 4px 10px rgba(0,0,0,.06);
                 background:#fff; border-radius:var(--tm-card-radius); padding:var(--tm-card-padding);
                 box-shadow:var(--tm-card-shadow); text-align:center;}
        .tm-card .tm-card-avatar{width:112px;height:112px;border-radius:50%;object-fit:cover;
                                 margin:0 auto 1rem; border:3px solid #fff; box-shadow:0 0 0 3px #a5b4fc;}
        .tm-card .tm-card-name{font-size:1.25rem;font-weight:600;color:#111827;margin:0 0 .25rem;}
        .tm-card .tm-card-role{font-size:1rem;color:#4f46e5;margin:0 0 1rem;}
        .tm-card .tm-card-socials{display:flex;justify-content:center;gap:.75rem;margin-top:1.25rem;}
        .tm-card .tm-card-social-link{color:#9ca3af;transition:color .2s;}
        .tm-card .tm-card-social-link:hover{color:#4f46e5;}
        .tm-card .tm-card-social-link svg{width:24px;height:24px;}
    </style>
</head>

<body>
    <!-- ====================== NAVBAR ====================== -->
    <header class="navbar">
        <div class="navbar__container">
            <a href="{{ url_for('main.index') }}" class="navbar__brand">LeadGen</a>

            <!-- Mobile toggle -->
            <button class="navbar__toggle" id="navbarToggle" aria-label="Open menu"
                    aria-controls="navbarMenu" aria-expanded="false">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>

            <!-- Menu (mobile + desktop) -->
            <nav class="navbar__menu" id="navbarMenu">
                <ul class="navbar__list">
                    <li class="navbar__item"><a href="{{ url_for('main.index') }}" class="navbar__link">Home</a></li>
                    <li class="navbar__item"><a href="{{ url_for('main.shop') }}" class="navbar__link">Shop</a></li>
                    <li class="navbar__item"><a href="{{ url_for('main.about') }}" class="navbar__link">About</a></li>
                    <li class="navbar__item"><a href="{{ url_for('main.cart') }}" class="navbar__link">Cart</a></li>

                    <!-- AUTH ITEM – will be replaced by JS -->
                    <li class="navbar__item navbar__item--cta" id="navbarAuthItem">
                        <a href="{{ url_for('auth.login') }}" class="navbar__link navbar__link--cta">Login</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- ====================== MAIN CONTENT ====================== -->
    <main class="content">
        {% block content %}{% endblock %}
    </main>

    <!-- ====================== FOOTER ====================== -->
    <footer class="footer-wave">
        <div class="container">
            <div class="footer-wave__main-grid">
                <div>
                    <h3 class="footer-wave__heading">Company</h3>
                    <ul class="footer-wave__links">
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Careers</a></li>
                        <li><a href="#">Press</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="footer-wave__heading">Support</h3>
                    <ul class="footer-wave__links">
                        <li><a href="#">Help Center</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">FAQs</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="footer-wave__heading">Legal</h3>
                    <ul class="footer-wave__links">
                        <li><a href="#">Privacy</a></li>
                        <li><a href="#">Terms</a></li>
                        <li><a href="#">Cookie Policy</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="footer-wave__heading">Follow Us</h3>
                    <ul class="footer-wave__links">
                        <li><a href="#">Twitter</a></li>
                        <li><a href="#">Instagram</a></li>
                        <li><a href="#">LinkedIn</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-wave__bottom">
                <p class="footer-wave__copyright">© {{ now.year }} LeadGen. All rights reserved.</p>
                <p>Made with love in Flask</p>
            </div>
        </div>
    </footer>

    <!-- ====================== SCRIPTS ====================== -->
    <script>
        /* ---------- Mobile Menu Toggle ---------- */
        document.addEventListener('DOMContentLoaded', () => {
            const toggle = document.getElementById('navbarToggle');
            const menu   = document.getElementById('navbarMenu');

            if (toggle && menu) {
                toggle.addEventListener('click', () => {
                    toggle.classList.toggle('is-active');
                    menu.classList.toggle('is-active');
                });
            }
        });

        /* ---------- Profile Dropdown (Login to Profile) ---------- */
        document.addEventListener('DOMContentLoaded', () => {
            const authItem = document.getElementById('navbarAuthItem');
            if (!authItem) return;

            // Use Flask g.user (set in @before_request)
            const username = "{{ g.user.username if g.user else '' }}".trim();
            const role     = "{{ g.user.role if g.user else '' }}".trim();

            if (username) {
                authItem.innerHTML = `
                    <div class="navbar__item navbar__item--cta" style="position:relative;">
                        <button class="navbar__link--cta" id="profileBtn" style="border:none; cursor:pointer;">
                            ${username} down arrow
                        </button>
                        <ul id="profileDropdown" style="
                            display:none; position:absolute; top:100%; right:0;
                            background:#fff; min-width:160px; z-index:100;
                            padding:0; list-style:none; box-shadow:0 4px 12px rgba(0,0,0,.1);
                            border-radius:8px; margin-top:4px;">
                            <li><a href="{{ url_for('auth.reset_password') }}" class="navbar__link"
                                   style="display:block;padding:.75rem 1rem;color:var(--color-text-primary);">
                                   Reset Password</a></li>
                            <li><a href="#" id="logoutBtn" class="navbar__link"
                                   style="display:block;padding:.75rem 1rem;color:var(--color-text-primary);">
                                   Logout</a></li>
                        </ul>
                    </div>
                `;

                const profileBtn = document.getElementById('profileBtn');
                const dropdown   = document.getElementById('profileDropdown');
                const logoutBtn  = document.getElementById('logoutBtn');

                profileBtn.addEventListener('click', e => {
                    e.stopPropagation();
                    dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                });

                document.addEventListener('click', () => {
                    dropdown.style.display = 'none';
                });

                logoutBtn.addEventListener('click', e => {
                    e.preventDefault();
                    fetch("{{ url_for('auth.logout') }}", { method: 'POST' })
                        .finally(() => location.reload());
                });
            }
        });
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>